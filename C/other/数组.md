# C语言基础：数组

## 引言
数组是C语言中用于存储固定大小顺序集合的变量，它是一种复合数据类型，可以有效地存储和管理相同类型的多个数据项。

## 基础概念
### 数组基础
#### **数组**
数组是一系列相同类型元素的集合，存储在连续的内存位置上。数组中的每个数据被称为元素，可以通过索引来访问数组中的元素
```c
int arr[5] = {1, 2, 3, 4, 5};
```
#### **二维数组**
二维数组可以视为数组的数组，通常用于存储表格数据。
```c
int arr[2][3] = {{1, 2, 3}, {4, 5, 6}};
```
#### **下标引用操作符**
可以用 `[]` 下标访问操作符访问元素的下标，下标索引从 0 开始，最大不超过数组的长度-1
```c
int arr[5] = {1, 2, 3, 4, 5};
int value = arr[2]; // 访问数组的第三个元素
```
### 基础知识
#### **数组的类型和存储大小**
- 强调数组元素的类型决定了数组中每个元素的大小，以及整个数组所占用的存储空间。
#### **数组的内存布局**
- 解释数组在内存中的连续布局，以及如何通过数组下标来访问特定的内存位置。
- 
![Screenshot_2024-04-21-20-33-52-933_tv.danmaku.bili.jpg](https://s1.vika.cn/space/2024/05/14/c7ee1b25448e4f9eb9306834d30bd11c)
## 进阶学习
### **数组与函数**
#### 传值调用
#### 传值调用：不加*
将实参的值传递给形参，形参的值改变不会影响实参的值
#### 传址调用：加*
将实参的地址传递给形参，形参的值改变会影响实参的值
### **指针和数组**
指针和数组紧密相关，数组名可以作为指向首元素的指针。
```C
int arr[5] = {1, 2, 3, 4, 5};
int *ptr = arr; // ptr 现在指向 arr 的第一个元素
```
### 其他操作
#### 将一维数组作为二维数组的元素 
```c
int main(){
    int arr[]={1,2,3};
    int arr1[]={2,3,4};
    int arr2[]={3,4,5};
    int*pa[3]={arr,arr1,arr2}; // 用指针数组来模拟二维数组
    for(int i=0;i<3;i++)
    {
        int j;
        for(j=0;j<3;j++)
        {
            printf("%d ",pa[i][j]); // pa[1]相当于访问arr数组,pa[1][j],相当于访问arr[j]
        }
        printf("\n");
    }
    return 0;
}
```

### 多维数组
#### 多维数组的展开计算下标
有一个二维数组 p，它的维度是 `m × n`。我们可以将其展开成一个一维数组，其中每个元素的下标 `i` 和 `j` 对应于原始二维数组中的行和列：
- 一维数组的下标 `k` 对应于二维数组中的元素 `arr[i][j]`，其中 `k = i * n + j`
#### 指针数组的解引用
- C 语言里，所有下标的表示法（如 `p[3]`），最后都会转换成这种 `*(p+3)` 。理解了这一点，那么，二维形式的  p[i][j]  会被转换成 `*(*(p + i) + j)`，即：`p[3][2]`会被转化成 `*(*(p +3) + 2)`
```C
// 指针数组p
//i代表行，j代表列
p[0][0] = a[0], p[0][1] = a[1], p[0][2] = a[2];
p[1][0] = a[3], p[1][1] = a[4], p[1][2] = a[5];
p[2][0] = a[6], p[2][1] = a[7], p[2][2] = a[8];
p[3][0] = a[9], p[3][1] = a[10], p[3][2] = a[11];
```
### 进阶操作
#### **数组的动态分配**
介绍如何在 C 语言中使用 `malloc` 或 `calloc` 动态分配数组，以及使用 `free` 释放内存的重要性。
```c
int size = 10;
int *dynamicArr = malloc(size * sizeof(int)); // 动态分配数组
// 使用完毕后释放内存
free(dynamicArr);
```
#### **变长数组**
- C 99 标准引入了变长数组，其大小可以在运行时确定，这使得数组的长度可以根据程序的需要而变化，但同时数组长度过大会引起栈溢出。
```C
#include <stdio.h>
int main() {
    int size;
    printf("Enter the size of the array: ");
    scanf("%d", &size);

    int array[size]; // 声明一个变长数组

    // 初始化数组
    for (int i = 0; i < size; i++) {
        array[i] = i;
    }

    // 打印数组
    for (int i = 0; i < size; i++) {
        printf("%d ", array[i]);
    }
    printf("\n");

    return 0;
}
```

### 编程实战
#### **字符串处理**
- 字符数组中字符串处理（如字符串长度计算、字符串复制、字符串比较等）是一个重要的主题。
```c
// 计算字符串长度
int strlen(const char *str) {
    int length = 0;
    while (*str++) {
        length++;
    }
    return length;
}
```

## 高级运用
### **数据结构与算法**
#### **数组排序**
使用算法如冒泡排序、选择排序或快速排序对数组进行排序。
```c
// 冒泡排序示例
for (int i = 0; i < n - 1; i++) {
    for (int j = 0; j < n - i - 1; j++) {
        if (arr[j] > arr[j + 1]) {
            int temp = arr[j];
            arr[j] = arr[j + 1];
            arr[j + 1] = temp;
        }
    }
}
```
#### 数组查找
使用线性查找或二分查找在数组中查找元素。

### **高级主题**
#### 数组的交错和嵌套
- 讨论如何定义和初始化交错数组（数组中的元素也是数组）和嵌套数组（多维数组）。
#### 数组的性能考虑
- 讨论数组的连续内存布局如何使得访问元素非常快，以及如何利用这一点来优化程序性能。
#### **数组的边界检查**
- 强调在进行数组操作时，始终进行边界检查以避免越界访问，这在防御性编程中非常重要。 

```c
if (index >= 0 && index < size) {
    // 安全的数组访问
} else {
    // 报告错误或处理越界情况
}
```
## 注意事项

### 学习难点
1. **多维数组与指针**：理解多维数组与指针的关系可能很复杂。
2. **指针运算**：指针运算需要谨慎，特别是在多维数组和指针数组中。
### 易错盘点
1. **数组的初始化**: 在声明数组时应初始化，数组未初始化可能导致程序中存在不确定的值，这些值可能引起程序错误。
2. **声明数组大小**：定义数组时，大小可以是已知的常量表达式或变量。
3. **数组赋值**：不能直接将单词和句子赋值给整个数组，必须逐个元素赋值或使用函数。
4. **数组退化成指针**：当数组作为函数参数传递时，它实际上传递了一个指针。所以，在函数内部无法直接获取数组的长度，需要额外传递一个参数来表示数组的大小。
### 常见问题
1. **数组越界访问**：始终确保数组访问的下标在合法范围内，可以通过合理的边界检查来避免数组越界
2. **内存泄漏**：在动态分配内存并使用数组时，确保在不再需要时及时释放内存，使用 `free()` 函数来释放动态分配的内存。
## 总结
本篇笔记介绍了C语言中数组的基础知识，包括数组的定义、使用和与指针的关系。我们还探讨了数组的高级应用，如排序和查找，以及在使用数组时应注意的事项和常见难点。理解这些概念对于编写高效且可靠的C程序至关重要。随着学习的深入，我们可以继续探索数组在更复杂数据结构和算法中的应用。
